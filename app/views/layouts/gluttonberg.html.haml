!!! Strict
%html{:xmlns => "http://www.w3.org/1999/xhtml", "xml:lang" => "en", :lang => "en"}
  %head
    %title= "#{website_title} #{@window_title.blank? ? '' : ' : ' + @window_title}"  
    %meta{"http-equiv" => "Content-Type", :content => "text/html;charset=utf-8" }/

    
    = stylesheet_link_tag "admin"
    
    = custom_stylesheet_link_tag
    
    = javascript_include_tag "jquery-1.4.2.min.js" , "jquery.dimensions.min.js" , "jquery-ui-1.8.1.custom.min.js" , "jquery.dragTree.js" , "rails" , "jquery.tagarea.js"
    
    = wysiwyg_js_css_link_tag
    
    = javascript_include_tag "gb_application" ,  :charset => "utf-8"
    
    = csrf_meta_tag 
    
    /[if IE 6]
      = stylesheet_link_tag "admin-ie6"

    /[if IE 7]
      = stylesheet_link_tag "admin-ie7"
    
  %body{:id => params[:controller].match(%r{\w+$}), :class => params[:action]}
    %div#sidebar
      %h2#navTitle Navigation

      %ul#navigation
        %li
          = link_to("Dashboard", admin_root_path, :id => "dashboard_nav" , :title => "Dashboard", :class => "page_item #{active_link?(admin_root_path)}")
        %li
          = link_to("Content", admin_content_path, :id => "content_nav" , :title => "Content", :class => "page_item #{active_link?(admin_content_path)}")
          %a.nav_trigger{ :href => "javascript:;" }
          %ul.subnavigation
            %li
              = link_to("Pages", admin_pages_path, :title => "Pages", :class => "#{active_link?(admin_pages_path)}")
            %li
              = link_to("Blogs", admin_blogs_path, :title => "Blogs", :class => "#{active_link?(admin_blogs_path)}")
            - for entry in Gluttonberg::Components.nav_entries
              -if entry[3].blank? || entry[3]==false || (entry[3]==true && session.user.is_super_admin)
                %li
                  = link_to(entry[0], entry[2], :html_options => {:id => (entry[0].to_s.underscore).gsub(/\s/, '_') + "Nav" , :title => entry[0] } )    
        %li
          = link_to("Library", admin_library_path, :id => "library_nav" , :title => "Library", :class => "page_item #{active_link?(admin_library_path)}")
          %a.nav_trigger{ :href => "javascript:;" }
          %ul.subnavigation
            %li
              = link_to("Add collection", new_admin_collection_url , :title => "Add collection", :class => "#{active_link?(new_admin_collection_url)}")
            %li
              = link_to("Add asset", new_admin_asset_url , :title => "Add asset", :class => "#{active_link?(new_admin_asset_url)}")
            %li
              = link_to("Add assets in bulk", admin_add_assets_in_bulk_url , :title => "Add assets in bulk", :class => "#{active_link?(admin_add_assets_in_bulk_url)}")
        %li
          = link_to("Settings", admin_settings_path, :id => "settings_nav" , :title => "Settings", :class => "page_item #{active_link?(admin_settings_path)}")
          %a.nav_trigger{ :href => "javascript:;" }
          %ul
            - if current_user.super_admin?       
              - if Gluttonberg.localized?
                %li= link_to("Locales", admin_locales_path , :title => "Locales", :class => "#{active_link?(admin_locales_path)}")

              %li= link_to("Configuration", admin_generic_settings_path , :title => "Configurations", :class => "#{active_link?(admin_generic_settings_path)}")
              %li= link_to("Users", admin_users_path, :title => "Users", :class => "#{active_link?(admin_users_path)}")  
            - else
              %li= link_to("Edit Account", edit_admin_user_path(current_user.id) , :title => "Users", :class => "#{active_link?(edit_admin_user_path(current_user.id))}")
    %div#wrapper
      %div#header
        %h1#sidebar_title= website_title
        %div#user
          Hello
          = link_to current_user.first_name, edit_admin_user_path(current_user.id), :class => "username"
          = link_to "Log Out", admin_logout_url, :class => "button"
      %div#subheader
        = image_tag(@page_image) unless @page_image.blank?
        %h2#pageTitle= @page_title.html_safe || "No title set"
        = contextual_help
      #content
        = yield